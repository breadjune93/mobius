<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Mobius</title>
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.8.2/css/all.min.css"/>
        <link rel="stylesheet" href="/css/fragments/modal.css">
        <link rel="stylesheet" href="/css/nexus.css">
    </head>

    <body>
        <header class="header">
            <div class="header-left">
                <div class="header-icon">
                    <img src="/image/mobius-nox.gif" alt="Mobius Agent" />
                </div>
                <h1 class="header-title">Mobius</h1>
            </div>
            <div class="header-controls">
                <button class="header-btn settings-btn" id="setting_btn" title="ì„¤ì •">
                    <i class="fa fa-cog"></i>
                </button>
            </div>
        </header>

        <div class="modal-overlay" id="setting_modal">
            <div class="modal-container">
                <div class="modal-header">
                    <h2>ì„¤ì •</h2>
                    <button name="close" class="modal-close-btn">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
<!--                <div class="modal-content">-->
<!--                    <div class="setting-section">-->
<!--                        <h3 class="setting-title">í…Œë§ˆ</h3>-->
<!--                        <div class="setting-item">-->
<!--                            <div class="theme-toggle-container">-->
<!--                                <button class="theme-toggle" id="modalThemeToggle">-->
<!--                                    <div class="theme-toggle-slider">-->
<!--                                        <span class="theme-icon theme-icon-dark">ğŸŒ™</span>-->
<!--                                        <span class="theme-icon theme-icon-light">â˜€ï¸</span>-->
<!--                                    </div>-->
<!--                                </button>-->
<!--                                <span class="theme-toggle-label" id="themeLabel">ë‹¤í¬ ëª¨ë“œ</span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->

<!--                    &lt;!&ndash; Logout Section &ndash;&gt;-->
<!--                    <div class="setting-section">-->
<!--                        <div class="setting-item logout-section">-->
<!--                            <button class="logout-btn" id="logoutBtn">-->
<!--                                <i class="fa fa-sign-out-alt"></i>-->
<!--                                ë¡œê·¸ì•„ì›ƒ-->
<!--                            </button>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->
                <div class="modal-footer">
                    <button name="close" class="modal-btn modal-btn-secondary">ì·¨ì†Œ</button>
                    <button name="submit" class="modal-btn modal-btn-primary">ì €ì¥</button>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="create_pylon_modal">
            <div class="modal-container">
                <div class="modal-header">
                    <h2>íŒŒì¼ëŸ° ìƒì„±</h2>
                    <button name="close" class="modal-close-btn">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
                <div class="modal-content">
                    <form name="create-pylon">
                        <div class="form-group">
                            <label for="pylon_title" class="form-label">ì œëª©</label>
                            <input
                                type="text"
                                id="pylon_title"
                                name="title"
                                class="form-input"
                                placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                                required
                                maxlength="50"
                            />
                        </div>
                        <div class="form-group">
                            <label for="pylon_description" class="form-label">ì„¤ëª…</label>
                            <textarea
                                id="pylon_description"
                                name="description"
                                class="form-textarea"
                                placeholder="ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                                required
                                maxlength="200"
                                rows="3"
                            ></textarea>
                        </div>
                        <div class="form-group">
                            <label for="pylon_type" class="form-label">ìœ í˜•</label>
                            <select id="pylon_type" name="type" class="form-select">
                                <option value="general">ì¼ë°˜</option>
                                <option value="plan">ì‘ì—…</option>
                            </select>
                        </div>

                        <div class="modal-footer">
                            <button type="button" name="close" class="modal-btn modal-btn-secondary">ì·¨ì†Œ</button>
                            <button type="submit" name="create-pylon" class="modal-btn modal-btn-primary">
                                <span>ìƒì„±</span>
                                <div class="loading-spinner" style="display: none;"></div>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="modal-overlay" id="edit_pylon_modal">
            <div class="modal-container">
                <div class="modal-header">
                    <h2>íŒŒì¼ëŸ° ìˆ˜ì •</h2>
                    <button name="close" class="modal-close-btn">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
                <div class="modal-content">
                    <form name="edit-pylon">
                        <input type="hidden" id="edit_pylon_id" name="pylon_id" />
                        <div class="form-group">
                            <label for="edit_pylon_title" class="form-label">ì œëª©</label>
                            <input
                                type="text"
                                id="edit_pylon_title"
                                name="title"
                                class="form-input"
                                placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”"
                                required
                                maxlength="50"
                            />
                        </div>
                        <div class="form-group">
                            <label for="edit_pylon_description" class="form-label">ì„¤ëª…</label>
                            <textarea
                                id="edit_pylon_description"
                                name="description"
                                class="form-textarea"
                                placeholder="ëŒ€í•œ ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”"
                                required
                                maxlength="200"
                                rows="3"
                            ></textarea>
                        </div>
                        <div class="form-group">
                            <label for="edit_pylon_type" class="form-label">ìœ í˜•</label>
                            <select id="edit_pylon_type" name="goal" class="form-select">
                                <option value="GENERAL">ì¼ë°˜</option>
                                <option value="PLAN">ì‘ì—…</option>
                            </select>
                        </div>

                        <div class="modal-footer">
                            <button type="button" name="close" class="modal-btn modal-btn-secondary">ì·¨ì†Œ</button>
                            <button type="submit" name="edit-pylon" class="modal-btn modal-btn-primary">
                                <span>ìˆ˜ì •</span>
                                <div class="loading-spinner" style="display: none;"></div>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="container">
            <!-- Pylon Controls -->
            <div class="title-section">
                <div class="title-left">
                    <div class="title-title">
                        <img src="/image/nexus.png" alt="Nexus Logo" class="nexus-logo" />
                        <h2 class="title-header">ë„¥ì„œìŠ¤</h2>
                    </div>
                    <span class="title-total-pylon" id="total_pylon">TOTAL - 0 Pylon</span>
                </div>
                <div class="title-right">
                    <button class="btn btn-primary" id="create_pylon">
                        <i class="fa fa-plus"></i>
                        íŒŒì¼ëŸ° ìƒì„±
                    </button>
                    <button class="btn btn-secondary" id="refresh_nexus">
                        <i class="fa fa-sync-alt"></i>
                        ìƒˆë¡œê³ ì¹¨
                    </button>
                </div>
            </div>

            <!-- Search Area -->
            <div class="search">
                <div class="search-group">
                    <div class="search-box">
                        <input type="text" id="search_pylon" class="search-input" placeholder="ê²€ìƒ‰...">
                        <i class="fa fa-search search-icon"></i>
                    </div>
                </div>
            </div>

            <!-- Pylon Area -->
            <div class="pylon" id="pylon_gallery">
<!--                <div class="pylon-group" data-space-id="1" onclick="joinRoom(1)">-->
<!--                    <div class="pylon-cover">-->
<!--                        <img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=400&h=250&fit=crop&crop=center" alt="ê°œë°œ ìƒë‹´">-->
<!--                        <div class="pylon-overlay">-->
<!--                            <div class="unread-badge">-->
<!--                                <i class="fa fa-comment-dots"></i>-->
<!--                                <span>+5</span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->

<!--                    <div class="pylon-content">-->
<!--                        <div class="pylon-header">-->
<!--                            <h3 class="pylon-title">í”„ë¡œì íŠ¸ ê°œë°œ ìƒë‹´</h3>-->
<!--                            <span class="pylon-type development">ê°œë°œ</span>-->
<!--                        </div>-->
<!--                        <p class="pylon-description">Reactì™€ Node.js í”„ë¡œì íŠ¸ ê´€ë ¨ ì§ˆë¬¸ê³¼ í•´ê²°ì±…ì„ ë…¼ì˜í•©ë‹ˆë‹¤</p>-->
<!--                        <div class="pylon-stats">-->
<!--                            <div class="stat-item">-->
<!--                                <i class="fa fa-user"></i>-->
<!--                                <span>ìœ ì € 7ëª…</span>-->
<!--                            </div>-->
<!--                            <div class="stat-item">-->
<!--                                <i class="fa fa-layer-group"></i>-->
<!--                                <span>ì—ì´ì „íŠ¸ 1ëª…</span>-->
<!--                            </div>-->
<!--                            <div class="stat-item">-->
<!--                                <i class="fa fa-clock"></i>-->
<!--                                <span>2025-01-15</span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->

                <div class="empty-state" id="pylon_empty">
                    <div class="empty-icon">
                        <i class="fa fa-place-of-worship"></i>
                    </div>
                    <h3>íŒŒì¼ëŸ°ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                    <p>ìƒˆë¡œìš´ íŒŒì¼ëŸ°ì„ ë§Œë“¤ì–´ ì—ì´ì „íŠ¸ì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.</p>
                </div>
            </div>
        </div>

<!--        <script src="/js/theme-toggle.js"></script>-->
        <script src="/js/modal.js"></script>
        <script src="/js/common/api.js"></script>
        <script src="/js/pylon-images.js"></script>
        <script>
            const pylonForm = document.querySelector("form[name=create-pylon]")
            const pylonButton = pylonForm.querySelector('button[name=create-pylon]');
            const pylonButtonText = pylonButton.querySelector("span");
            const pylonLoadingSpinner = pylonButton.querySelector(".loading-spinner");

            const editPylonForm = document.querySelector("form[name=edit-pylon]")
            const editPylonButton = editPylonForm.querySelector('button[name=edit-pylon]');
            const editPylonButtonText = editPylonButton.querySelector("span");
            const editPylonLoadingSpinner = editPylonButton.querySelector(".loading-spinner");

            window.pylonCreateModal = new Modal(
                document.querySelector("#create_pylon"),
                document.querySelector("#create_pylon_modal"),
                null
            );

            window.pylonEditModal = new Modal(
                null,
                document.querySelector("#edit_pylon_modal"),
                null
            );

            document.addEventListener("DOMContentLoaded", async function() {
                await getPylons();
            })

            pylonForm.addEventListener("submit", async function(e) {
                e.preventDefault();
                await createPylon();
            })

            editPylonForm.addEventListener("submit", async function(e) {
                e.preventDefault();
                await updatePylon();
            })

            // ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
            document.getElementById("refresh_nexus").addEventListener("click", function() {
                location.reload();
            })

            // ê²€ìƒ‰ ê¸°ëŠ¥
            document.getElementById("search_pylon").addEventListener("input", function(e) {
                searchPylons(e.target.value);
            })

            async function getPylons() {
                try {
                    const response = await window.api.get('/api/v1/nexus/pylons');
                    const body = await response.body;

                    if (response.status) {
                        const pylons = await body['pylons'];

                        const pylonContainer = document.getElementById('pylon_gallery');
                        const pylonEmpty = document.getElementById('pylon_empty');
                        const totalPylon = document.getElementById('total_pylon');

                        if (pylons && pylons.length > 0) {
                            // ë¹ˆ ìƒíƒœ ìˆ¨ê¸°ê¸°
                            pylonEmpty.style.display = 'none';

                            // íŒŒì¼ëŸ° ê°œìˆ˜ ì—…ë°ì´íŠ¸
                            totalPylon.textContent = `total - ${pylons.length} Pylon`;

                            // íŒŒì¼ëŸ° ì¹´ë“œ ìƒì„±
                            pylons.forEach(pylon => {
                                const pylonCard = createPylonCard(pylon);
                                pylonContainer.insertBefore(pylonCard, pylonEmpty);
                            });
                        } else {
                            // íŒŒì¼ëŸ°ì´ ì—†ìœ¼ë©´ ë¹ˆ ìƒíƒœ í‘œì‹œ
                            pylonEmpty.style.display = 'block';
                            totalPylon.textContent = 'total - 0 Pylon';
                        }
                    } else {
                        alert(body.detail || 'íŒŒì¼ëŸ° ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    alert(error.detail || 'Pylonì„ ì¡°íšŒí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
            }

            function createPylonCard(pylon) {
                const pylonGroup = document.createElement('div');
                pylonGroup.className = 'pylon-group';
                pylonGroup.setAttribute('data-space-id', pylon.id);
                pylonGroup.onclick = () => joinPylon(pylon.id);

                // íƒ€ì…ì— ë”°ë¥¸ í´ë˜ìŠ¤ ì„¤ì •
                const typeClass = pylon.goal.toLowerCase();
                const typeText = pylon.goal === 'PLAN' ? 'ì‘ì—…' : 'ì¼ë°˜';

                // ë‚ ì§œ í¬ë§·íŒ…
                const createdDate = new Date(pylon.created_at).toISOString().split('T')[0];

                pylonGroup.innerHTML = `
                    <div class="pylon-cover">
                        <img src="${pylon.image_url || getRandomPylonImage()}" alt="${pylon.title}">
                        <div class="pylon-overlay">
                            <div class="pylon-actions">
                                <button class="pylon-action-btn edit-btn" onclick="event.stopPropagation(); openEditModal(${pylon.id})" title="ìˆ˜ì •">
                                    <i class="fa fa-cog"></i>
                                </button>
                                <button class="pylon-action-btn delete-btn" onclick="event.stopPropagation(); deletePylon(${pylon.id})" title="ì‚­ì œ">
                                    <i class="fa fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="pylon-content">
                        <div class="pylon-header">
                            <h3 class="pylon-title">${pylon.title}</h3>
                            <span class="pylon-type ${typeClass}">${typeText}</span>
                        </div>
                        <p class="pylon-description">${pylon.description}</p>
                        <div class="pylon-stats">
                            <div class="stat-item">
                                <i class="fa fa-user"></i>
                                <span>ìœ ì € ${pylon.user_count}ëª…</span>
                            </div>
                            <div class="stat-item">
                                <i class="fa fa-layer-group"></i>
                                <span>ì—ì´ì „íŠ¸ ${pylon.agent_count}ëª…</span>
                            </div>
                            <div class="stat-item">
                                <i class="fa fa-clock"></i>
                                <span>${createdDate}</span>
                            </div>
                        </div>
                    </div>
                `;

                return pylonGroup;
            }

            function joinPylon(pylonId) {
                window.location.href = `/pylon?id=${pylonId}`;
            }

            async function createPylon() {
                // í¼ ë°ì´í„° ìˆ˜ì§‘
                const formData = new FormData(pylonForm);
                const data = Object.fromEntries(formData.entries());

                // ëœë¤ ì´ë¯¸ì§€ URL ì¶”ê°€
                data.image_url = getRandomPylonImage();

                isCompleted(false);

                try {
                    const response = await window.api.post('/api/v1/nexus/pylon', data);
                    console.log("response: ", response);

                    if (response && response.ok) {
                        const result = await response.json();
                        console.log('íŒŒì¼ëŸ° ìƒì„± ì™„ë£Œ:', result);

                        // ëª¨ë‹¬ ë‹«ê¸°
                        window.pylonCreateModal.close();

                        // í¼ ì´ˆê¸°í™”
                        pylonForm.reset();

                        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                        location.reload();

                        alert('íŒŒì¼ëŸ°ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else if (response) {
                        const error = await response.json();
                        alert(error.detail || 'íŒŒì¼ëŸ° ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Pylon creation error:', error);
                    alert('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                } finally {
                    isCompleted(true);
                }
            }

            function isCompleted(flag) {
                pylonButton.disabled = !flag;
                pylonButtonText.textContent = !flag ? "ë¡œê·¸ì¸ ì¤‘..." : "ë¡œê·¸ì¸";
                pylonLoadingSpinner.style.display = !flag ? "inline-block" : "none";
            }

            function isEditCompleted(flag) {
                editPylonButton.disabled = !flag;
                editPylonButtonText.textContent = !flag ? "ìˆ˜ì • ì¤‘..." : "ìˆ˜ì •";
                editPylonLoadingSpinner.style.display = !flag ? "inline-block" : "none";
            }

            async function openEditModal(pylonId) {
                try {
                    const response = await window.api.get(`/api/v1/nexus/pylon/${pylonId}`);

                    if (response && response.ok) {
                        const result = await response.json();
                        const pylon = result.pylon;

                        // í¼ì— ë°ì´í„° ì±„ìš°ê¸°
                        document.getElementById('edit_pylon_id').value = pylon.id;
                        document.getElementById('edit_pylon_title').value = pylon.title;
                        document.getElementById('edit_pylon_description').value = pylon.description;
                        document.getElementById('edit_pylon_type').value = pylon.goal;

                        // ëª¨ë‹¬ ì—´ê¸°
                        window.pylonEditModal.open();
                    } else if (response) {
                        const error = await response.json();
                        alert(error.detail || 'íŒŒì¼ëŸ° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Failed to load pylon:', error);
                    alert('íŒŒì¼ëŸ° ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
            }

            async function updatePylon() {
                const pylonId = document.getElementById('edit_pylon_id').value;
                const formData = new FormData(editPylonForm);
                const data = Object.fromEntries(formData.entries());

                isEditCompleted(false);

                try {
                    const response = await window.api.put(`/api/v1/nexus/pylon/${pylonId}`, data);
                    console.log("response: ", response);

                    if (response && response.ok) {
                        const result = await response.json();

                        // íŒŒì¼ëŸ° ìˆ˜ì • ì„±ê³µ
                        console.log('Pylon updated successfully:', result);

                        // ëª¨ë‹¬ ë‹«ê¸°
                        window.pylonEditModal.close();

                        // í¼ ì´ˆê¸°í™”
                        editPylonForm.reset();

                        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                        location.reload();

                        alert('íŒŒì¼ëŸ°ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else if (response) {
                        const error = await response.json();
                        alert(error.detail || 'íŒŒì¼ëŸ° ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Pylon update error:', error);
                    alert('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                } finally {
                    isEditCompleted(true);
                }
            }

            async function deletePylon(pylonId) {
                if (!confirm('ì •ë§ë¡œ ì´ íŒŒì¼ëŸ°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    return;
                }

                try {
                    const response = await window.api.delete(`/api/v1/nexus/pylon/${pylonId}`);
                    console.log("response: ", response);

                    if (response && response.ok) {
                        const result = await response.json();

                        // íŒŒì¼ëŸ° ì‚­ì œ ì„±ê³µ
                        console.log('Pylon deleted successfully:', result);

                        // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
                        location.reload();

                        alert('íŒŒì¼ëŸ°ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                    } else if (response) {
                        const error = await response.json();
                        alert(error.detail || 'íŒŒì¼ëŸ° ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Pylon delete error:', error);
                    alert('ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                }
            }

            function searchPylons(keyword) {
                const pylonGroups = document.querySelectorAll('.pylon-group');
                const pylonEmpty = document.getElementById('pylon_empty');
                const searchKeyword = keyword.toLowerCase().trim();
                let visibleCount = 0;

                pylonGroups.forEach(group => {
                    const title = group.querySelector('.pylon-title')?.textContent.toLowerCase() || '';
                    const description = group.querySelector('.pylon-description')?.textContent.toLowerCase() || '';

                    if (searchKeyword === '' || title.includes(searchKeyword) || description.includes(searchKeyword)) {
                        group.style.display = '';
                        visibleCount++;
                    } else {
                        group.style.display = 'none';
                    }
                });

                // ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì„ ë•Œ ë¹ˆ ìƒíƒœ í‘œì‹œ
                if (visibleCount === 0 && searchKeyword !== '') {
                    pylonEmpty.style.display = 'block';
                    pylonEmpty.querySelector('h3').textContent = 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤';
                    pylonEmpty.querySelector('p').textContent = `"${keyword}"ì— ëŒ€í•œ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`;
                } else if (visibleCount === 0 && searchKeyword === '') {
                    pylonEmpty.style.display = 'block';
                    pylonEmpty.querySelector('h3').textContent = 'íŒŒì¼ëŸ°ì´ ì—†ìŠµë‹ˆë‹¤';
                    pylonEmpty.querySelector('p').textContent = 'ìƒˆë¡œìš´ íŒŒì¼ëŸ°ì„ ë§Œë“¤ì–´ ì—ì´ì „íŠ¸ì™€ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.';
                } else {
                    pylonEmpty.style.display = 'none';
                }

                // ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
                const totalPylon = document.getElementById('total_pylon');
                if (searchKeyword === '') {
                    totalPylon.textContent = `TOTAL - ${pylonGroups.length} Pylon`;
                } else {
                    totalPylon.textContent = `ê²€ìƒ‰ ê²°ê³¼ - ${visibleCount} Pylon`;
                }
            }
        </script>
    </body>
</html>